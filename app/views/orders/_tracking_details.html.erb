<div id="order_tracking_section" class="card mb-4 shadow-sm border-0">
  <div class="card-header bg-white border-bottom-0 pt-4 pb-0">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0 fw-bold"><%= t('order_tracking') %> #<%= order.id %></h5>
      <span class="badge rounded-pill bg-<%= order.status == 'delivered' ? 'success' : (order.status == 'cancelled' ? 'danger' : 'primary') %> px-3 py-2">
        <%= t("order.status.#{order.status}") %>
      </span>
    </div>
  </div>
  
  <div class="card-body">
    <!-- Estimated Delivery -->
    <% if order.estimated_delivery_date.present? && order.status != 'delivered' && order.status != 'cancelled' %>
      <div class="mb-4 p-3 bg-light rounded">
        <p class="text-muted mb-0">
          <i class="bi bi-truck me-2"></i><%= t('estimated_delivery') %>: 
          <span class="fw-bold text-dark"><%= l(order.estimated_delivery_date, format: :long) %></span>
        </p>
      </div>
    <% end %>

    <!-- Stepper -->
    <% unless order.status == 'cancelled' %>
      <div class="tracking-stepper my-5 position-relative">
        <div class="progress" style="height: 4px; background-color: #e9ecef; border-radius: 0.25rem;">
          <div class="progress-bar bg-success" role="progressbar" style="width: <%= order.percentage_complete %>%;" aria-valuenow="<%= order.percentage_complete %>" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <div class="d-flex justify-content-between position-relative" style="margin-top: -14px;">
          <% Order::ORDER_STEPS.each do |step| %>
            <div class="step-item text-center <%= order.step_status(step) %>" style="width: 25%;">
              <div class="step-circle">
                <% if order.step_status(step) == 'completed' || order.step_status(step) == 'active' %>
                  <i class="bi bi-check-lg text-white" style="font-size: 10px; font-weight: bold;"></i>
                <% end %>
              </div>
              <div class="step-label mt-2 text-uppercase fw-bold" style="font-size: 0.75rem; letter-spacing: 0.5px;"><%= t("order.status.#{step}") %></div>
            </div>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="alert alert-danger d-flex align-items-center mb-4">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <%= t('order_cancelled_message') %>
      </div>
    <% end %>

    <hr class="my-4 text-muted" style="opacity: 0.1;">

    <!-- Shipping Info -->
    <h6 class="text-uppercase text-muted small fw-bold mb-3"><%= t('shipping_details') %></h6>
    <div class="row g-3">
      <div class="col-md-6">
        <div class="d-flex align-items-start p-3 border rounded h-100">
          <div class="me-3 text-primary bg-primary-subtle p-2 rounded-circle">
            <i class="bi bi-person-fill"></i>
          </div>
          <div>
            <div class="fw-bold text-dark mb-1"><%= order.name %></div>
            <div class="text-muted small"><i class="bi bi-envelope me-1"></i><%= order.email %></div>
            <div class="text-muted small"><i class="bi bi-telephone me-1"></i><%= order.phone %></div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="d-flex align-items-start p-3 border rounded h-100">
          <div class="me-3 text-primary bg-primary-subtle p-2 rounded-circle">
            <i class="bi bi-geo-alt-fill"></i>
          </div>
          <div>
            <div class="fw-bold text-dark mb-1"><%= t('shipping_address') %></div>
            <div class="text-muted small"><%= order.address %></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
